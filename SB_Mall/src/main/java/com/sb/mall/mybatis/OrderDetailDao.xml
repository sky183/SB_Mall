<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.sb.mall.dao.OrderDetailDao">
 
 	<insert id="insert"	parameterType="com.sb.mall.model.OrderDetail">
 	</insert>
 	
	<delete id="delete" parameterType="int">
	</delete>

	<select id="selectAll" resultType="com.sb.mall.model.OrderDetail">
		select * from OrderDetail where status<![CDATA[<>]]>4 and orderDetailNum<![CDATA[<>]]>0
	</select>
	
	<select id="selectColumn" resultType="com.sb.mall.model.OrderDetail" parameterType="map">
	</select>
	
	<select id="selectJoin" resultType="com.sb.mall.model.OrderDetail" parameterType="map">
	</select>
	
	<select id="selectMemberOrderDetail" resultType="com.sb.mall.model.OrderDetail" parameterType="map">
	</select>
	
	<select id="selectOrderDetail" resultType="com.sb.mall.model.OrderDetail" parameterType="String">
		select * from
		OrderDetail where orderDetailNum = #{orderDetailNum}
	</select>
	
	<select id="thisMonthAverage" resultType="String">
		SELECT sum(totalAmount) / DAYOFMONTH(NOW()) totalAmount FROM OrderDetail WHERE
	( orderTime <![CDATA[>]]> LAST_DAY(NOW() - interval 1 month) AND orderTime <![CDATA[<=]]> LAST_DAY(NOW()))
	</select>
	
	<select id="preMonthAverage" resultType="String"  parameterType="int">
		SELECT sum(totalAmount) / DAYOFMONTH(NOW()) totalAmount FROM OrderDetail WHERE
	( orderTime <![CDATA[>]]> LAST_DAY(NOW() - interval #{interval}+1 month) AND orderTime <![CDATA[<=]]> LAST_DAY(NOW()- interval #{interval} month))
	</select>
	
	<select id="thisMonthAmount" resultType="String">
	SELECT sum(totalAmount) FROM OrderDetail WHERE
	( orderTime <![CDATA[>]]> LAST_DAY(NOW() - interval 1 month) AND orderTime <![CDATA[<=]]> LAST_DAY(NOW()))
	</select>
	<select id="preMonthAmount" resultType="String" parameterType="int">
	SELECT sum(totalAmount) FROM OrderDetail WHERE
	( orderTime <![CDATA[>]]> LAST_DAY(NOW() - interval #{interval}+1 month) AND orderTime <![CDATA[<=]]> LAST_DAY(NOW()- interval #{interval} month))
	</select>
	
	<select id="selectCount" resultType="int">
		select count(*) from OrderDetail where status<![CDATA[<>]]>4 and orderDetailNum<![CDATA[<>]]>0
	</select>
	
	<select id="selectList" resultType="com.sb.mall.model.OrderDetail">
		select * from
		OrderDetail where status<![CDATA[<>]]>4 and orderDetailNum<![CDATA[<>]]>0 limit #{param1}, #{param2}
	</select>
	
	<update id="updateStatus" parameterType="String">
		UPDATE OrderDetail SET status = status +1
		WHERE orderDetailNum = #{orderDetailNum}
	</update>
	
	<select id="selectOrderDetail_userSqe" resultType="com.sb.mall.model.OrderDetail" parameterType="map">
		select * from OrderDetail where userSeq = #{userSeq}
	</select>
	
	<select id="selectOrderDetail_Cnt" resultType="com.sb.mall.model.OrderDetail" parameterType="map">
		select count(*) from OrderDetail where userSeq = #{userSeq}
	</select>
	

	
	
	
	
 </mapper>