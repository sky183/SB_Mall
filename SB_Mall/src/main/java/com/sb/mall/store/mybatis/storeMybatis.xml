<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.sb.mall.store.dao.StoreDao">
 	<insert id="insertSalesBoard"
 		parameterType="com.sb.mall.store.model.SalesBoard"
 		useGeneratedKeys="true" keyColumn="salesSeq" keyProperty="salesSeq">
 		insert into SalesBoard (title,text,viewSeq,writeDate,userSeq,productSeq)
 		value(#{title},#{text},0,now(),#{userSeq},#{productSeq})
 	</insert>
 	<insert id="insertProduct"
 		parameterType="com.sb.mall.store.model.Product"
 		useGeneratedKeys="true" keyColumn="productSeq" keyProperty="productSeq">
 		insert into Product (price,productName,photo,detail) 
 		value(#{price},#{productName},#{photo},#{detail})
 	</insert>
 	<select id="selectProAndSalList" resultType="map">
 		SELECT distinct * FROM SalesBoard s,Product p 
 		<where>
 			<if test="param1!=null">
 				(p.productName LIKE CONCAT('%',#{param1},'%') 
 				or s.title LIKE CONCAT('%',#{param1},'%')) and
 			</if>
 			s.productSeq=p.productSeq  
 		</where>
 		order by ${param2} limit #{param3},#{param4}
 	</select>
 	<select id="selectProAndSal" resultType="map">
 		SELECT distinct * FROM SalesBoard s,Product p where s.salesSeq=#{salSeq} 
 		and s.productSeq=p.productSeq;
 	</select>
 	<select id="selectProductList" resultType="com.sb.mall.store.model.Product">
 		SELECT * FROM Product order by productSeq desc;
 	</select>
 	<select id="selectSalBoardList" resultType="com.sb.mall.store.model.SalesBoard">
 		SELECT * FROM SalesBoard order by salesSeq desc;
 	</select>
 	<select id="countProAndSalList" resultType="int">
 		SELECT count(*) from SalesBoard s,Product p 
 		<where>
 			<if test="value!=null">
 				(p.productName LIKE CONCAT('%',#{param1},'%') 
 				or s.title LIKE CONCAT('%',#{param1},'%')) and
 			</if>
 			s.productSeq=p.productSeq
 		</where>
 	</select>
 	<select id="selectSalBoard" resultType="com.sb.mall.store.model.SalesBoard">
 		SELECT * FROM SalesBoard where salesSeq=#{salSeq}
 	</select>
 	<update id="updateSalBoardCnt">
 		update SalesBoard set viewSeq=viewSeq+1 where salesSeq=#{salSeq}
 	</update>
 	<update id="updateSalesBoard">
 		update SalesBoard set title=#{title},text=#{text} where salesSeq=#{salesSeq}
 	</update>
 	<delete id="deleteSalesBoard">
 		delete from `SalesBoard` where salesSeq=#{salSeq}
 	</delete>
 </mapper>