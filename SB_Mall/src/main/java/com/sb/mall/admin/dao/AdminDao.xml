<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="com.sb.mall.admin.dao.AdminDao">
 	
 	<!--  -->
 	<select id="visitCountTotal" resultType="int">
		select ifnull(sum(visitCount),0) from VisitGuest
	</select>
	<!--  -->
	<select id="visitCountDay" resultType="int">
		SELECT ifnull(sum(visitcount),0) FROM VisitGuest WHERE date(visitDate) = date(#{obj})
	</select>
	<!--  -->
	<select id="visitCountDayPre" resultType="int">
		SELECT ifnull(sum(visitcount),0) FROM VisitGuest WHERE date(visitDate) = curDate() - interval #{interval} day
	</select>
	<!--  -->
	<select id="orderDayCount" resultType="int">
		SELECT ifnull(count(*),0) orderCount FROM OrderDetail WHERE date(orderTime) = date(#{obj}) and status  <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="orderDayCountPre" resultType="int">
		SELECT ifnull(count(*),0) orderCount FROM OrderDetail WHERE date(orderTime) = date(now() - interval #{interval} day) and status <![CDATA[>]]> 0;
	</select>
	<!--  -->
	<select id="salesDay" resultType="Long">
		SELECT ifnull(sum(totalAmount),0) totalAmount FROM OrderDetail where date(orderTime) = date(#{obj}) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="salesDayPre" resultType="Long">
		SELECT ifnull(sum(totalAmount), 0) totalAmount FROM OrderDetail where date(orderTime) = date(now() - interval #{interval} day) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="salesMonth" resultType="Long">
		SELECT ifnull(sum(totalAmount), 0) totalAmount FROM OrderDetail where month(orderTime) = month(#{obj}) and year(orderTime) = year(#{obj}) and  status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="salesMonthPre" resultType="Long">
		SELECT sum(totalAmount) totalAmount FROM OrderDetail where month(orderTime) = month(now() - interval #{interval} month) and year(orderTime) = year(now()) and  status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="salesYear" resultType="Long">
		SELECT sum(totalAmount) totalAmount FROM OrderDetail where year(orderTime) = year(#{obj}) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="salesYearPre" resultType="Long">
		SELECT sum(totalAmount) totalAmount FROM OrderDetail where year(orderTime) = year(now() - interval #{interval} year) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="averageMonth" resultType="Long">
		SELECT sum(totalAmount) / DAYOFMONTH(LAST_DAY(#{obj}) totalAmount FROM OrderDetail WHERE	month(orderTime) = month(#{obj}) and year(orderTime) = year(#{obj}) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="averageThisMonth" resultType="Long">
		SELECT sum(totalAmount) / DAY(NOW()) FROM OrderDetail WHERE month(orderTime) = month(NOW()) and year(orderTime) = year(NOW()) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="averageMonthPre" resultType="Long">
		SELECT sum(totalAmount) / DAYOFMONTH(LAST_DAY(NOW() - interval #{interval} month)) totalAmount FROM OrderDetail WHERE	month(orderTime) = month(now() - interval #{interval} month) and year(orderTime) = year(now() - interval #{interval} month) and status <![CDATA[>]]> 0
	</select>
	<!--  -->
	<select id="orderStatus" resultType="map">
		SELECT status, ifnull(count(status), 0) count FROM SB_Master.OrderDetail group by status order by status;
	</select>
	<!--  -->
	<select id="joinCount" resultType="int">
		SELECT count(*) FROM SB_Master.MemberInfo where date(regDate) = date(#{obj});
	</select>
	<!--  -->
	<select id="joinCountPre" resultType="int">
		SELECT count(*) FROM SB_Master.MemberInfo where date(regDate) = date(now() - interval #{interval} day);
	</select>
	
 
 </mapper>